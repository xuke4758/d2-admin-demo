(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c7a95"],{5224:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("d2-container",[i("div",{staticClass:"d2-mt d2-mb"},[i("el-button",{attrs:{type:"primary"},on:{click:e.add_user}},[e._v("添加角色")])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userlist}},[i("el-table-column",{attrs:{prop:"role_name",label:"角色名称",width:"120"}}),i("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"}}),i("el-table-column",{attrs:{prop:"updated_at",label:"更新时间",width:"180"}}),i("el-table-column",{attrs:{prop:"description",label:"描述",width:"500"}}),i("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"d2-text-center"},[i("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),e.edit_user(t.$index)}}},[e._v(" 修改信息 ")])],1),i("div",{staticClass:"d2-text-center d2-mt"},[i("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),e.edit_power(t.$index)}}},[e._v(" 修改权限 ")])],1),i("div",{staticClass:"d2-text-center d2-mt"},[i("el-button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(i){return i.preventDefault(),e.del_user(t.$index)}}},[e._v(" 删除 ")])],1)]}}])})],1),i("el-dialog",{attrs:{title:"角色编辑",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"角色名称"}},[i("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{placeholder:"请输入角色描述",type:"textarea",rows:3},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.confim_user}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"确定删除吗",visible:e.dialogVisible2,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose2}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.delete_user}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"修改权限",visible:e.dialogVisible3,width:"70%"},on:{"update:visible":function(t){e.dialogVisible3=t}}},[e.loading_show?i("div",{},[e._v("加载中")]):i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{id:"menutab",data:e.menu,border:""}},[i("el-table-column",{attrs:{label:"主菜单",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-checkbox",{attrs:{label:t.row.name},on:{change:function(i){return e.menuchange(t.row)}},model:{value:t.row.status,callback:function(i){e.$set(t.row,"status",i)},expression:"scope.row.status"}})]}}])}),i("el-table-column",{attrs:{label:"子菜单",width:"600"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.permission,(function(s,n){return[i("el-checkbox",{attrs:{label:s.name},on:{change:function(i){return e.menuchange(t.row.permission[n])}},model:{value:s.status,callback:function(t){e.$set(s,"status",t)},expression:"item.status"}})]}))]}}])})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose3}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.confim_permission_user}},[e._v("确 定")])],1)])],1)},n=[],o=i("9bd2"),r={rolelist:function(e){return Object(o["a"])({url:"/role",method:"get",data:e})},newrole:function(e){return Object(o["a"])({url:"/role",method:"post",data:e})},getrole:function(e){return Object(o["a"])({url:"/role/".concat(e.id,"/edit"),method:"get",data:e})},editrole:function(e){return Object(o["a"])({url:"/role/".concat(e.id),method:"put",data:e})},deleterole:function(e){return Object(o["a"])({url:"/role/".concat(e.id),method:"delete",data:e})},roleuppermission:function(e){return Object(o["a"])({url:"/role/uppermission",method:"post",data:e})}},l={name:"systemuser",data:function(){return{menu:[],userlist:[],dialogVisible:!1,dialogVisible2:!1,dialogVisible3:!1,form:{role_name:"",description:""},form2:{role_name:"",description:""},loading_show:!0}},mounted:function(){this.getuserlist()},methods:{confim_permission_user:function(){var e=this,t=this.form,i=this.menu,s=[];for(var n in i)for(var o in i[n].status&&s.push(i[n].id),i[n].permission)i[n].permission[o].status&&s.push(i[n].permission[o].id);t.data=s,r.roleuppermission(t).then((function(t){e.$message({message:"修改成功",type:"success"}),e.handleClose3(),e.getuserlist()}))},menuchange:function(e){var t=this.menu,i=e.status;if(e.parent)for(var s in t[e.index].permission)t[e.index].permission[s].status=i;else if(e.children){var n=0;for(var o in t[e.parentindex].permission)t[e.parentindex].permission[o].status&&(n=1);t[e.parentindex].status=!!n}},edit_power:function(e){var t=this;this.loading_show=!0,this.dialogVisible3=!0,this.form=this.userlist[e],this.menu=[],r.getrole({id:this.form.id}).then((function(e){t.loading_show=!1;var i=e.permissionData;for(var s in i)for(var n in i[s].parent=1,i[s].index=s,i[s].status=!!i[s].status,i[s].permission)i[s].permission[n].children=1,i[s].permission[n].parentindex=s,i[s].permission[n].index=s,i[s].permission[n].status=!!i[s].permission[n].status;t.menu=i}))},getuserlist:function(){var e=this;r.rolelist().then((function(t){e.userlist=t}))},edit_user:function(e){this.form=this.userlist[e],this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1,this.form=JSON.parse(JSON.stringify(this.form2))},add_user:function(){this.handleClose(),this.dialogVisible=!0},confim_user:function(){var e=this,t=this.form;t.id?r.editrole(t).then((function(t){e.$message({message:"修改成功",type:"success"}),e.handleClose(),e.getuserlist()})):r.newrole(t).then((function(t){e.$message({message:"创建成功",type:"success"}),e.handleClose(),e.getuserlist()}))},del_user:function(e){this.form=this.userlist[e],this.dialogVisible2=!0},handleClose2:function(){this.dialogVisible2=!1,this.form=JSON.parse(JSON.stringify(this.form2))},handleClose3:function(){this.dialogVisible3=!1,this.form=JSON.parse(JSON.stringify(this.form2))},delete_user:function(){var e=this;r.deleterole(this.form).then((function(t){e.$message({message:"删除成功",type:"success"}),e.handleClose2(),e.getuserlist()}))}}},a=l,u=i("2877"),d=function(e){e.options.__source="src/views/systemmanage/role/index.vue"},c=d,m=Object(u["a"])(a,s,n,!1,null,null,null);"function"===typeof c&&c(m);t["default"]=m.exports}}]);